function [fileList,folderList] = F_walkFolders1(filePath, extension)% This function creates a list of all files and folders in the directories% in and below the current directory that have the designated file% extension%%   for example:     [files,folders]=F_walkFolders1(cd,'.f10')% fileNames = dir(filePath); % Get names of all files & folders in current folderfileList = []; % List will hold file names whose extension matches input arg 'extension'folderList = [];     folderList = strvcat(folderList,[filePath  ]);for i = 1 : length(fileNames)	fName = fileNames(i);    if (fName.isdir & not(strcmpi(fName.name,'.')) & not(strcmpi(fName.name,'..'))) 	% If name is a directory, recurse ...		newFilePath = [filePath '\' fName.name ''];  % ... on this new path            %folderList = strvcat(folderList,[filePath  fName.name '']);        [files,folders] = F_walkFolders1(newFilePath, extension);        fileList = strvcat(fileList,files ); % Append new matches to old        for k = 1:size(folders)            folderList = strvcat(folderList,[folders(k,1:end) '']);        end	else 			% Name is file, not directory, so check the extension		[path, name, ext] = fileparts([filePath fName.name]);        ext = lower(ext);        extension = lower(extension);		if ( strcmpi(ext, extension) | (strcmpi(extension, '.f*') & (strmatch('.f',ext ))) )	% If it matches extension we want, save it			fileList = strvcat(fileList, [filePath '\'  fName.name]);		end	endend